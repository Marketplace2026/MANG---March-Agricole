<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Online Shop â€“ Sell Live Marketplace</title>

<meta name="description" content="Discover this online shop on Sell Live. View products, prices, and contact the shop owner directly via WhatsApp.">

<meta name="keywords" content="online shop, boutique en ligne, marketplace shop, seller shop, ecommerce store">

<meta name="robots" content="index, follow">

<link rel="canonical" href="https://fiacre06.github.io/Sell-live/shop.html">

<!-- Open Graph -->
<meta property="og:title" content="Online Shop â€“ Sell Live">
<meta property="og:description" content="Visit this shop on Sell Live and contact the owner directly via WhatsApp.">
<meta property="og:url" content="https://fiacre06.github.io/Sell-live/shop.html">
<meta property="og:type" content="website">
<meta property="og:image" content="https://fiacre06.github.io/Sell-live/assets/preview.png">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Online Shop â€“ Sell Live">
<meta name="twitter:description" content="Discover shops and products on Sell Live marketplace.">
<style>
:root{
  --primary:#2e8b57;
  --secondary:#1f2937;
  --bg:#f4f6f8;
  --card:#ffffff;
  --text:#374151;
  --muted:#6b7280;
  --shadow:0 10px 25px rgba(0,0,0,.08);
}

*{box-sizing:border-box;}

body{
  margin:0;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
  background:var(--bg);
  color:var(--text);
}

.container{
  max-width:1200px;
  margin:auto;
  padding:20px;
}

.header{
  display:flex;
  flex-wrap:wrap;
  gap:15px;
  justify-content:space-between;
  align-items:center;
  background:linear-gradient(135deg,var(--primary),#3cb371);
  color:white;
  padding:25px;
  border-radius:18px;
  box-shadow:var(--shadow);
}

.header h2{
  margin:0;
  font-size:1.8rem;
}

button{
  border:none;
  border-radius:999px;
  padding:10px 18px;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}

#copyLinkBtn{
  background:white;
  color:var(--primary);
}

#copyLinkBtn:hover{
  transform:translateY(-2px);
  opacity:.9;
}

#visitSiteBtn{
  background:var(--primary);
  color:white;
  margin-top:10px;
}

#visitSiteBtn:hover{
  background:#246b45;
}

.owner{
  margin:20px 5px 5px;
  font-size:.95rem;
  color:var(--muted);
}

.site-invite{
  background:var(--card);
  padding:20px;
  border-radius:16px;
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  gap:10px;
  margin-bottom:30px;
}

.products-grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(230px,1fr));
  gap:22px;
}

.productCard{
  background:var(--card);
  border-radius:18px;
  overflow:hidden;
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  transition:.25s;
}

.productCard:hover{
  transform:translateY(-6px);
}

.productCard img{
  width:100%;
  height:170px;
  object-fit:cover;
}

.productCard h4{
  margin:12px 12px 5px;
  font-size:1.1rem;
}

.productCard p{
  margin:0 12px 10px;
  font-size:.9rem;
  color:var(--muted);
  flex-grow:1;
}

.productCard strong{
  margin:10px 12px 15px;
  font-size:1.05rem;
  color:var(--primary);
}

@media(max-width:600px){
  .header{
    text-align:center;
    justify-content:center;
  }
}
  /* ===== LIVRAISON BADGE ===== */
.livraison-badge{
  display:inline-block;
  padding:8px 14px;
  border-radius:999px;
  font-size:.85rem;
  font-weight:600;
  margin-bottom:8px;
}

.livraison-oui{
  background:#e6f6ee;
  color:#2e8b57;
  border:1px solid #2e8b57;
}

.livraison-non{
  background:#fceaea;
  color:#b91c1c;
  border:1px solid #b91c1c;
}

/* ===== WHATSAPP BUTTON ===== */
.whatsapp-btn{
  display:inline-block;
  margin-top:6px;
  padding:10px 16px;
  border-radius:999px;
  background:#25D366;
  color:white;
  font-weight:600;
  text-decoration:none;
  transition:.2s;
}

.whatsapp-btn:hover{
  opacity:.9;
  transform:translateY(-2px);
}
</style>
</head>

<body>

<div class="container">

  <div class="header">
    <h2 id="shopName">Boutique</h2>
    <button id="copyLinkBtn">ðŸ”— Copier le lien</button>
  </div>

  <div class="owner" id="shopOwner">PropriÃ©taire : ...</div>

  <!-- AJOUT INFO LIVRAISON + WHATSAPP -->
  <div class="owner" id="shopExtras"></div>

  <div class="site-invite">
    <p>
      Bienvenue dans notre boutique en ligne.  
      DÃ©couvrez nos produits sÃ©lectionnÃ©s avec soin et profitez des meilleures offres.
    </p>
    <button id="visitSiteBtn">ðŸ›’ Visiter le site principal</button>
  </div>

  <div class="products-grid" id="productsContainer"></div>

</div>

<script type="module">
import { supabase } from './supabase.js';

const urlParams = new URLSearchParams(window.location.search);
const shopId = urlParams.get('id');

const shopNameEl = document.getElementById('shopName');
const shopOwnerEl = document.getElementById('shopOwner');
const shopExtrasEl = document.getElementById('shopExtras');
const productsContainer = document.getElementById('productsContainer');

const copyLinkBtn = document.getElementById('copyLinkBtn');
const visitSiteBtn = document.getElementById('visitSiteBtn');

if (!shopId) {
  alert("ID de boutique manquant !");
  throw new Error("ID de boutique manquant");
}

copyLinkBtn.onclick = () => {
  navigator.clipboard.writeText(window.location.href)
    .then(() => alert("Lien copiÃ© !"));
};

visitSiteBtn.onclick = () => {
  window.location.href = "index.html";
};

async function loadShop() {
  const { data: shop, error } = await supabase
    .from('shops')
    .select('*')
    .eq('id', shopId)
    .single();

  if (error || !shop) {
    productsContainer.innerHTML = "<p style='color:red;'>Boutique introuvable</p>";
    return;
  }

  shopNameEl.textContent = shop.name || "Boutique";

  let ownerName = "Inconnu";
  if (shop.owner_id) {
    const { data: owner } = await supabase
      .from('profiles')
      .select('username')
      .eq('id', shop.owner_id)
      .single();
    if (owner) ownerName = owner.username;
  }

  shopOwnerEl.textContent = "PropriÃ©taire : " + ownerName;

  /* ===== LIVRAISON + WHATSAPP ===== */
  let extrasHTML = "";

  extrasHTML += shop.livraison
  ? `<span class="livraison-badge livraison-oui">ðŸšš Livraison disponible</span><br>`
  : `<span class="livraison-badge livraison-non">ðŸ“¦ Livraison non disponible</span><br>`;

if (shop.whatsapp) {
  const phone = shop.whatsapp.replace(/\s+/g,'');
  extrasHTML += `
    <a href="https://wa.me/${phone}" target="_blank" class="whatsapp-btn">
      Contacter la boutique
    </a>
  `;
}

  shopExtrasEl.innerHTML = extrasHTML;

  const { data: products } = await supabase
    .from('shop_products')
    .select('*')
    .eq('shop_id', shopId)
    .order('created_at', { ascending: false });

  if (!products || products.length === 0) {
    productsContainer.innerHTML = "<p>Aucun produit disponible</p>";
    return;
  }

  products.forEach(p => {
    const div = document.createElement('div');
    div.className = 'productCard';
    div.innerHTML = `
      ${p.image_url ? `<img src="${p.image_url}" alt="${p.name}">` : ""}
      <h4>${p.name}</h4>
      <p>${p.description || ""}</p>
      <strong>${p.price} FCFA</strong>
    `;
    productsContainer.appendChild(div);
  });
}

loadShop();
</script>

</body>
</html>
