  <!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MANG ‚Äì March√© Agricole Nouvelle G√©n√©ration</title>

<style>
/* =====================================================
   VARIABLES
===================================================== */
:root{
  --green:#1f8a5b;
  --green-dark:#166b45;
  --bg:#f4faf6;
  --dark:#102a23;
  --gray:#5f6f68;
  --radius:22px;
  --shadow:0 20px 50px rgba(0,0,0,.15);
}

/* =====================================================
   RESET
===================================================== */
*{margin:0;padding:0;box-sizing:border-box}
body{
  font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;
  background:var(--bg);
  color:var(--dark);
  overflow-x:hidden;
}

/* =====================================================
   SPLASH SCREEN
===================================================== */
#splash{
  position:fixed;
  inset:0;
  background:linear-gradient(135deg,#e8fff2,#d7f2e5);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:9999;
  animation:fadeOut 1.2s ease forwards;
  animation-delay:3.2s;
}
#splash img{width:300px;animation:logoPulse 1.8s infinite}
#splash h1{
  margin-top:15px;
  font-size:2.2em;
  font-weight:900;
  color:var(--green-dark);
  text-align:center;
}
@keyframes logoPulse{
  0%{transform:scale(1)}
  50%{transform:scale(1.08)}
  100%{transform:scale(1)}
}
@keyframes fadeOut{to{opacity:0;visibility:hidden}}

/* =====================================================
   HEADER
===================================================== */
header{
  background:
    linear-gradient(rgba(16,42,35,.85),rgba(16,42,35,.92)),
    url("assets/img/hero-people.jpg") center/cover no-repeat;
  color:#fff;
  padding:10px 10px 10px;
}
.nav{
  
  margin:0px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.nav img{height:230px;
         width:100%;
        }
.hero{
  max-width:900px;
  margin:auto;
  text-align:center;
}
.hero h2{
  font-size:3rem;
  font-weight:900;
  margin-bottom:20px;
}
.hero p{
  font-size:1.2em;
  line-height:1.7;
  margin-bottom:38px;
}
.hero-actions{
  display:flex;
  justify-content:center;
  gap:18px;
  flex-wrap:wrap;
}
.hero-actions button{
  padding:16px 48px;
  border-radius:999px;
  border:none;
  font-weight:900;
  font-size:1.05em;
  cursor:pointer;
  box-shadow:var(--shadow);
}
#loginBtn{background:#fff;color:var(--green-dark)}
#signupBtn{
  background:linear-gradient(135deg,var(--green),var(--green-dark));
  color:#fff;
}
.trust{
  margin-top:45px;
  display:flex;
  justify-content:center;
  gap:16px;
  flex-wrap:wrap;
}
.trust span{
  background:rgba(255,255,255,.15);
  padding:12px 20px;
  border-radius:999px;
  font-weight:600;
}

/* =====================================================
   MAIN
===================================================== */
main{
  max-width:1200px;
  margin:100px auto;
  padding:0 20px;
}
section{margin-bottom:120px}
section h3{
  text-align:center;
  font-size:2.4em;
  font-weight:900;
  margin-bottom:18px;
}
.subtitle{
  text-align:center;
  max-width:820px;
  margin:0 auto 70px;
  color:var(--gray);
  font-size:1.1em;
  line-height:1.8;
}

/* FEATURES */
.features{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:32px;
}
.feature{
  background:#fff;
  padding:34px;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  transition:.3s;
}
.feature:hover{transform:translateY(-10px)}
.feature h4{
  color:var(--green-dark);
  margin-bottom:12px;
}
.feature p{color:var(--gray);line-height:1.7}

/* IMAGE SECTIONS */
.image-section{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:50px;
  align-items:center;
}
.image-section img{
  width:100%;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}
.image-section h4{font-size:2em;margin-bottom:14px}
.image-section p{line-height:1.8;color:var(--gray)}

/* =====================================================
   SIDEBAR AUTH
===================================================== */
.sidebar{
  position:fixed;
  top:0;
  right:-420px;
  width:380px;
  max-width:100%;
  height:100vh;
  background:#fff;
  box-shadow:-10px 0 40px rgba(0,0,0,.2);
  padding:30px;
  transition:.35s;
  z-index:9998;
}
.sidebar.open{right:0}
.close-btn{
  background:none;
  border:none;
  font-size:1.4em;
  cursor:pointer;
  float:right;
}
.sidebar h3{
  margin:40px 0 20px;
  font-size:1.6em;
  color:var(--green-dark);
}
.sidebar input{
  width:100%;
  padding:14px;
  margin-bottom:14px;
  border-radius:12px;
  border:1px solid #ccc;
  font-size:1em;
}
.password-wrapper{position:relative}
.toggle-pass{
  position:absolute;
  right:15px;
  top:50%;
  transform:translateY(-50%);
  cursor:pointer;
}
.action-btn{
  width:100%;
  padding:14px;
  border:none;
  border-radius:999px;
  font-weight:900;
  background:linear-gradient(135deg,var(--green),var(--green-dark));
  color:#fff;
  cursor:pointer;
  margin-top:10px;
}
.error{
  color:red;
  text-align:center;
  margin-top:10px;
}

  .wallet-section {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 40px;
  padding: 60px 10%;
  background: linear-gradient(135deg, #0f3d3e, #082c2d);
  color: white;
  flex-wrap: wrap;
}

.wallet-image img {
  max-width: 350px;
  border-radius: 20px;
  box-shadow: 0 15px 40px rgba(0,0,0,0.3);
}

.wallet-content {
  max-width: 500px;
}

.wallet-content h4 {
  font-size: 28px;
  margin-bottom: 20px;
}

.wallet-content p {
  margin-bottom: 20px;
  line-height: 1.6;
}

.wallet-features {
  list-style: none;
  padding: 0;
  margin-bottom: 25px;
}

.wallet-features li {
  margin-bottom: 10px;
  font-size: 16px;
}

.wallet-btn {
  display: inline-block;
  padding: 12px 25px;
  background: #28a745;
  color: white;
  text-decoration: none;
  border-radius: 8px;
  font-weight: bold;
  transition: 0.3s;
}

.wallet-btn:hover {
  background: #218838;
}
/* MOBILE */
@media(max-width:900px){
  .hero h2{font-size:2.2em}
  .image-section{grid-template-columns:1fr}
}
</style>
</head>

<body>

<!-- SPLASH -->
<div id="splash">
  <img src="assets/img/logos.png" alt="Logo MANG">
  <h1>March√© Agricole<br>Nouvelle G√©n√©ration</h1>
</div>

<header>
  <div class="nav">
    <img src="assets/img/logos.png" alt="MANG">
  </div>

  <div class="hero">
    <h2>MANG ‚Äì Le march√© agricole nouvelle g√©n√©ration</h2>
    <p>La plateforme qui connecte producteurs et acheteurs agricoles sans interm√©diaires.</p>

    <div class="hero-actions">
      <button id="loginBtn">Se connecter</button>
      <button id="signupBtn">S'inscrire</button>
    </div>

    <div class="trust">
      <span>üå± Agricole</span>
      <span>üí¨ Messagerie</span>
      <span>üè™ Boutiques</span>
      <span>üìà Visibilit√©</span>
    </div>
  </div>
</header>

<main>

<section>
  <h3>Pourquoi choisir MANG ?</h3>
  <p class="subtitle">Une nouvelle fa√ßon de vendre et d‚Äôacheter localement.</p>

  <div class="features">
    <div class="feature"><h4>üì¶ Produits</h4><p>Publie facilement tes produits agricoles.</p></div>
    <div class="feature"><h4>üí¨ Discussion</h4><p>N√©gocie directement avec les acheteurs.</p></div>
    <div class="feature"><h4>üè™ Boutique</h4><p>Un profil cr√©dible et visible.</p></div>
    <div class="feature">
  <h4>üîê Portefeuille num√©rique</h4>
  <p>G√©rez vos transactions en toute s√©curit√©, directement depuis votre compte MANG.</p>
</div>
  </div>
</section>
<section class="image-section">
  <img src="assets/img/community.jpg" alt="Producteurs et acheteurs heureux">
  <div>
    <h4>Une communaut√© agricole unie</h4>
    <p>
      MANG rassemble producteurs, productrices et acheteurs
      autour d‚Äôun objectif commun :
      mieux vendre, mieux acheter et mieux collaborer.
    </p>
  </div>
</section>

  <section class="image-section">
  <img src="assets/img/producteurs.png" alt="Trois producteurs montrant l'application MANG sur leurs t√©l√©phones">
  <div>
    <h4>La technologie au service des producteurs</h4>
    <p>
      Gr√¢ce √† MANG, les producteurs peuvent g√©rer leur activit√©
      directement depuis leur t√©l√©phone.
      Publication des produits, messagerie, notifications et suivi des ventes :
      tout est accessible en quelques clics,
      sans interm√©diaires et en toute simplicit√©.
    </p>
  </div>
  </section>

  <section class="image-section">
    <img src="assets/img/portefeuille.png" alt="Interface du portefeuille num√©rique MANG affich√©e sur smartphone">
  </div>

  <div>
    <h4>üí≥ Un portefeuille num√©rique int√©gr√©</h4>
    <p>
      Avec MANG, chaque utilisateur dispose d‚Äôun portefeuille personnel s√©curis√©.
      Recevez vos paiements, envoyez de l‚Äôargent et g√©rez vos transactions
      directement depuis l‚Äôapplication, sans interm√©diaires.
    </p>

    <ul class="wallet-features">
      <li>‚úÖ R√©ception instantan√©e des paiements</li>
      <li>üí∏ Envoi d‚Äôargent rapide et s√©curis√©</li>
      <li>üîÑ Recharge de solde simplifi√©e</li>
      <li>üè¶ Retrait facile vers mobile money ou banque</li>
      <li>üìä Historique des transactions en temps r√©el</li>
    </ul>

    <a href="#" class="wallet-btn">Cr√©er mon portefeuille</a>
  </div>
  </section>
  
<section class="image-section">
  <div>
    <h4>Ils parlent de MANG</h4>
    <p>
      Les utilisateurs recommandent MANG parce qu‚Äôils y trouvent
      des opportunit√©s r√©elles, des contacts directs
      et une nouvelle mani√®re de faire du commerce agricole.
    </p>
  </div>
  <img src="assets/img/testimonial.jpg" alt="T√©moignage utilisateur">
</section>
</main>

<!-- SIDEBAR AUTH -->
<div class="sidebar" id="sidebar">
  <button class="close-btn" id="closeSidebar">‚úñ</button>
  <h3 id="formTitle">Connexion</h3>
  <input id="username" placeholder="Nom d'utilisateur" style="display:none">
  <input id="email" type="email" placeholder="Email">
  <div class="password-wrapper">
    <input id="password" type="password" placeholder="Mot de passe">
    <span class="toggle-pass" id="togglePass">üëÅ</span>
  </div>
  <button id="actionBtn" class="action-btn">Se connecter</button>
  <p id="forgotPassword" style="text-align:center;color:var(--green);cursor:pointer;margin-top:10px;">
    Mot de passe oubli√© ?
  </p>
  <div class="error" id="errorMsg"></div>
</div>

<!-- üî• TON SCRIPT SUPABASE RESTE IDENTIQUE üî• -->

          
    <script type="module">
import { supabase } from './supabase.js';

document.addEventListener('DOMContentLoaded', () => {

  const sidebar = document.getElementById('sidebar');
  const closeSidebar = document.getElementById('closeSidebar');
  const loginBtn = document.getElementById('loginBtn');
  const signupBtn = document.getElementById('signupBtn');

  const formTitle = document.getElementById('formTitle');
  const actionBtn = document.getElementById('actionBtn');
  const errorMsg = document.getElementById('errorMsg');
  const usernameInput = document.getElementById('username');
  const emailInput = document.getElementById('email');
  const passwordInput = document.getElementById('password');
  const togglePass = document.getElementById('togglePass');
  const forgotPassword = document.getElementById('forgotPassword');

  let isLogin = true;

  /* ===== UI ===== */
  loginBtn.onclick = () => {
    isLogin = true;
    sidebar.classList.add('open');
    usernameInput.style.display = 'none';
    formTitle.textContent = "Connexion";
    actionBtn.textContent = "Se connecter";
    errorMsg.textContent = "";
    forgotPassword.style.display = "block";
  };

  signupBtn.onclick = () => {
    isLogin = false;
    sidebar.classList.add('open');
    usernameInput.style.display = 'block';
    formTitle.textContent = "Inscription";
    actionBtn.textContent = "S'inscrire";
    errorMsg.textContent = "";
    forgotPassword.style.display = "none";
  };

  closeSidebar.onclick = () => {
    sidebar.classList.remove('open');
    emailInput.value = "";
    passwordInput.value = "";
    usernameInput.value = "";
    errorMsg.textContent = "";
  };

  togglePass.onclick = () => {
    passwordInput.type =
      passwordInput.type === "password" ? "text" : "password";
  };

  /* ===== Mot de passe oubli√© ===== */
  forgotPassword.onclick = async () => {
    const email = emailInput.value.trim();
    if (!email) {
      errorMsg.textContent = "Entre ton email pour r√©initialiser le mot de passe";
      return;
    }

    const { error } = await supabase.auth.resetPasswordForEmail(email, {
      redirectTo: "https://marketplace2026.github.io/MANG---March-Agricole//reset-password.html"
    });

    if (error) {
      errorMsg.textContent = error.message;
      return;
    }

    alert("üì© Un email de r√©initialisation a √©t√© envoy√© !");
  };

  /* ===== Auth ===== */
  actionBtn.onclick = async () => {
    errorMsg.textContent = "";

    const email = emailInput.value.trim();
    const password = passwordInput.value.trim();
    const username = usernameInput.value.trim();

    if (!email || !password || (!isLogin && !username)) {
      errorMsg.textContent = "Remplis tous les champs";
      return;
    }

    if (isLogin) {
      /* ===== LOGIN ===== */
      const { error } = await supabase.auth.signInWithPassword({ email, password });
      if (error) {
        errorMsg.textContent = error.message;
        return;
      }
      window.location.href = "index.html";
      return;
    }

    /* ===== SIGNUP ===== */
    const { data: signUpData, error: signUpError } = await supabase.auth.signUp({
      email,
      password,
      options: { data: { username } }
    });

    if (signUpError) {
      errorMsg.textContent = signUpError.message;
      return;
    }

    const userId = signUpData.user.id;
    const now = new Date().toISOString();

    try {
      /* ===== Cr√©er profil minimal dans profiles ===== */
      const { error: insertProfileError } = await supabase.from("profiles").insert({
        id: userId,
        username: username || "Utilisateur",
        email: email,
        is_acheteur: true,
        is_vendeur: true,
        created_at: now,
        last_seen: now,
        coins: 0,           // coins dans profiles
        premium_level: 'free',
        premium_start: null,
        premium_end: null
      });
      if (insertProfileError) throw insertProfileError;

      /* ===== Cr√©er wallet associ√© dans wallets ===== */
      const { error: insertWalletError } = await supabase.from("wallets").insert({
        user_id: userId,
        balance: 0,
        available_balance: 0,
        coins: 0,                  // si tu veux suivre les coins aussi dans wallet
        wallet_number: generateWalletNumber()
      });
      if (insertWalletError) throw insertWalletError;

      alert("‚úÖ Compte cr√©√© ! Tu peux maintenant te connecter.");
      sidebar.classList.remove('open');
      emailInput.value = "";
      passwordInput.value = "";
      usernameInput.value = "";
      errorMsg.textContent = "";

    } catch (err) {
      console.error("Erreur cr√©ation utilisateur :", err);
      errorMsg.textContent = "‚ùå Impossible de cr√©er le compte, v√©rifie la console";
    }

  };

});

/* ===== G√©n√©rer un wallet_number unique ===== */
function generateWalletNumber() {
  // Exemple : 10 chiffres al√©atoires
  return Math.floor(1000000000 + Math.random() * 9000000000).toString();
}
    </script>

</body>
</html>
